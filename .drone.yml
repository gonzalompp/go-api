kind: pipeline
name: default
steps:
- name: test
  image: golang:1.14
  commands:
    - "go mod download"
    - "go test -race ./..."
- name: build
  image: golang:1.14
  commands:
    - "go build cmd/api/main.go"
- name: dockerhub
  image: plugins/docker
  settings:
    repo: gonzalompp/go-api
    username:
      from_secret: dockerhub_unsermane
    password:
      from_secret: dockerhub_password
    tags:
      - latest